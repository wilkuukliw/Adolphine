<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Create account</title>
      <link type="text/css" rel="stylesheet" href="/api/global.css">
      <link href="https://fonts.googleapis.com/css2?family=Faster+One&family=Thasadith&display=swap" rel="stylesheet">
      <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
      <link rel="icon" href="/api/img/calendar.png">
   </head>
   <body>
      <form action="/signup" method="POST" name="accountSubmit" onsubmit="return validateForm()">
         <div class="form-row align-items-center">
            <label for="username"><b>Username</b></label>
            <input type="text" placeholder="Enter Username" name="username" id="username" required>   
            <label for="password"><b>Password</b></label>
            <input type="password" placeholder="Enter Password" name="password" id="password" required>
            <label for="passwordRepeat"><b>Please repeat password</b></label>
            <input type="password" placeholder="Repeat Password" name="passwordRepeat" id="passwordRepeat" required>
            <button type="submit" id="submit" >Create</button>
         </div>
      </form>
      <script>
         function validateForm() {
             const username = document.forms.accountSubmit.username.value;
             const password = document.forms.accountSubmit.password.value;
             const passwordRepeat = document.forms.accountSubmit.passwordRepeat.value;
             const email = username.concat("@simcorp.com");

             //emailregex

             if (username.length < 2 || username.length > 4) {
                 Swal.fire("Please provide correct SC initials");
                 return false;
             }
         
             if (password.length < 8 || passwordRepeat.length < 8) {
                 Swal.fire("Password needs to be at least 8 characters long");
                 return false;
             }

            if (password != passwordRepeat) {
                Swal.fire("Password is not matching");
                return false;
              }

             return true;
             
         }
         
         $("#submit").click(function() {

             var username = $("#username").val();
             var password = $("#password").val();
             var passwordRepeat = $("#passwordRepeat").val(); 
            

             if ( username == '' || password == '' || passwordRepeat == '' ) {
             
             Swal.fire({
                title: "Fields empty",
                text: "Please fill the missing fields",
                icon: "warning",
                button: "OK"
             });

          } else {
                Swal.fire({
                  title: "Account has been created succesfully",
                  text: "You can now log in",
                  icon: "success",
                  //confirmButtonColor: '#3085d6',
                  confirmButtonText: 'OK'
                }).then(function(result) {
                  if (result.value) {
                    location.assign("http://localhost:5005/login")
                  }
              });
             }}
         );
      </script>
   </body>
</html>